package vulnerability

import "github.com/anchore/vulnscan-db/pkg/db"

type mockStore struct {
	data map[string]map[string][]db.Vulnerability
}

func newMockStore() *mockStore {
	d := mockStore{
		data: make(map[string]map[string][]db.Vulnerability),
	}
	d.stub()
	return &d
}

func (d *mockStore) stub() {
	d.data["debian:8"] = map[string][]db.Vulnerability{
		"neutron": {
			{
				Name:            "neutron",
				NamespaceName:   "debian:8",
				Version:         "2014.1.3-6",
				VulnerabilityID: "CVE-2014-fake-1",
				VersionFormat:   "dpkg",
			},
			{
				Name:            "neutron",
				NamespaceName:   "debian:8",
				Version:         "2013.0.2-1",
				VulnerabilityID: "CVE-2013-fake-2",
				VersionFormat:   "dpkg",
			},
		},
	}
}

func (d *mockStore) Add(v *db.Vulnerability) error {
	return nil
}

func (d *mockStore) Get(namespace, name string) ([]db.Vulnerability, error) {
	return d.data[namespace][name], nil
}
